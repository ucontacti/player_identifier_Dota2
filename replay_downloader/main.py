# "5926851979",
# "5926732118",
# "5926596132",
# "5926498037",
# "5926402991",
# "5926374493",
# "5926212113",
# "5926148072",
# "5926065815",
# "5925119996",
# "5924956181",
# "5924812056",
# "5924712320",
# "5924610089",
# "5924507520",
# "5924430391",
# "5924343990",
# "5924231037",
# "5924160626",
# "5924068428",
# "5922871615",
# "5922768273",
# "5922679457",
# "5922602670",
# "5922512609",
# "5922438740",
# "5922379061",
# "5922293044",
# "5922226336",
# "5922162182",
# "5921084683",
# "5920993291",
# "5920889352",
# "5920806694",
# "5920714068",
# "5920638214",
# "5920564188",
# "5920494710",
# "5920449253",
# "5920377449",
# "5919422016",
# "5919286556",
# "5919165162",
# "5919074158",
# "5918982217",
# "5918906877",
# "5918832729",
# "5918743805",
# "5918691827",
# "5917514439",
# "5917443590",
# "5917380765",
# "5917363866",
# "5917346943",
# "5917291951",
# "5917291859",
# "5917274351",
# "5917225412",
# "5917211403",
# "5917193218",
# "5917145096",

#####"5917146218",
match_id_list = ["5917120517",
"5917079092",
"5917058918",
"5917058856",
"5916999738",
"5917003906",
"5916999615",
"5916953224",
"5916945544",
"5916941505",
"5916889731",
"5916888278",
"5916890798",
"5915868132",
"5915833606",
"5915824015",
"5915724586",
"5915726519",
"5915716111",
"5915624630",
"5915613886",
"5915595819",
"5915536193",
"5915536982",
"5915537315",
"5915448730",
"5915422921",
"5915392078",
"5915345931",
"5915342620",
"5915332620",
"5915287855",
"5915269041",
"5915261814",
"5915209811",
"5915211623",
"5915204336",
"5915155650",
"5915141664",
"5915136220",
"5915090081",
"5915088482",
"5915090628",
"5913776533",
"5913646124",
"5913525580",
"5913415296",
"5913341774",
"5913299413",
"5913253454",
"5913209921",
"5913161793",
"5913152001",
"5913118125",
"5913070678",
"5913013389",
"5913000523",
"5912945803",
"5912941693",
"5911478535",
"5911457723",
"5911377278",
"5911353934",
"5911279219",
"5911258834",
"5911183098",
"5911144067",
"5911045449",
"5911032765",
"5910973712",
"5910938862",
"5910896035",
"5910870410",
"5910802032",
"5910801480"]
import requests, json
import urllib.request

counter = 1
for match in match_id_list:
    stringurl = "https://api.opendota.com/api/replays?match_id=" + match
    raw_data = requests.get(stringurl, allow_redirects=True)
    json_data = json.loads(raw_data.content.decode())

    demo_url = "http://replay" + str(json_data[0]["cluster"]) + ".valve.net/570/" + str(json_data[0]["match_id"]) + "_" + str(json_data[0]["replay_salt"]) + ".dem.bz2"
    save_to = "downloads/" + match + ".dem.bz2"
    print("Getting ready to download replay " + str(counter) + " match_id: " + match)
    urllib.request.urlretrieve(demo_url, save_to)
    print("Downloaded replay " + str(counter))
    counter += 1