match_id_list = [
    # "6003863417",
    # "5991708740",
    # "5982534279",
    # "5968616834",
    # "5965367985",
    # "5897702660",
    # "5897463627",
    # "5891735843",
    # "5891624838",
    # "5876785622",
    # "5876695429",
    # "5872814822",
    # "5872679752",
    # "5866577606",
    # "5856603116",
    # "5811658334",
    # "5707370161",
    # "5681817283",
    # "5678303131",
    # "5639623825",
    # "5536512014",
    # "5519238168",
    # "5494563706",
    # "5487119249",
    # "5422285071",
    # "5405526944",
    # "5390160914",
    # "5380057572",
    # "5326872901",
    # "5151162765",

    # "6023742995",
    # "6022177534",
    # "6018212531",
    "6001694307",
    "6001298688",
    "6000983626",
    "6000062110",
    "5993525225",
    "5984859915",
    "5984783994",
    "5983263514",
    "5983057378",
    "5978072667",
    "5969008571",
    "5965724249",
    "5964370826",
    "5962442499",
    "5962365078",
    "5960698901",
    "5960538017",
    "5957598154",
    "5954355499",
    "5952464231",
    "5948576960",
    "5948149219",
    "5941846266",
    "5920558248",
    "5918806164",
    "5910767865",
    "5900276154",
    "5884457866",
    "5879077026",
    "5870990063",
    "5869865116",
    "5863880168",
    "5820576922",
    "5808584619",
    "5807080843",
    "5802540164",
    "5918913874"
]
import requests, json
import urllib.request

counter = 1
for match in match_id_list:
    stringurl = "https://api.opendota.com/api/replays?match_id=" + match
    raw_data = requests.get(stringurl, allow_redirects=True)
    json_data = json.loads(raw_data.content.decode())

    demo_url = "http://replay" + str(json_data[0]["cluster"]) + ".valve.net/570/" + str(json_data[0]["match_id"]) + "_" + str(json_data[0]["replay_salt"]) + ".dem.bz2"
    save_to = "downloads/" + match + ".dem.bz2"
    print("Getting ready to download replay " + str(counter) + " match_id: " + match)
    urllib.request.urlretrieve(demo_url, save_to)
    print("Downloaded replay " + str(counter))
    counter += 1